{"cells":[{"cell_type":"code","source":["%fs\nrm superusersdata"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"ff0e8f95-d05d-4375-b705-202715f8d306"}},"outputs":[],"execution_count":0},{"cell_type":"code","source":["foldername=\"superusersdata\"\nfilename=\"animals.csv\"\ndbutils.fs.mkdirs(foldername)\nfilepath=foldername+\"/\"+filename\ndata=\"Id,Navn\\n1,Hest\\n2,Kat\\n3,Hund\"\ndbutils.fs.put(filepath,data,True)"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"74abd329-08e6-4e5a-ba92-8bad8e899f5a"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">Wrote 27 bytes.\nOut[1]: True</div>","removedWidgets":[],"addedWidgets":{},"metadata":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">Wrote 27 bytes.\nOut[1]: True</div>"]}}],"execution_count":0},{"cell_type":"code","source":["foldername=\"superusersdata\"\nfilename=\"animals.csv\"\nfilepath=foldername+\"/\"+filename\nprint(dbutils.fs.head(filepath))"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"289ffc83-683c-492d-9b5a-7a4c805d4d2e"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">Id,Navn\n1,Hest\n2,Kat\n3,Hund\n</div>","removedWidgets":[],"addedWidgets":{},"metadata":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">Id,Navn\n1,Hest\n2,Kat\n3,Hund\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\nDROP TABLE animalsTable"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"44c09e8e-f024-43f4-bbab-27234c3b72a0"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr></tr></thead><tbody></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["foldername=\"superusersdata\"\ndbutils.fs.ls(foldername)"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"702e12a2-7907-4a99-b83b-300364efee15"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">Out[2]: [FileInfo(path=&#39;dbfs:/superusersdata/animals.csv&#39;, name=&#39;animals.csv&#39;, size=27, modificationTime=1652954550000)]</div>","removedWidgets":[],"addedWidgets":{},"metadata":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">Out[2]: [FileInfo(path=&#39;dbfs:/superusersdata/animals.csv&#39;, name=&#39;animals.csv&#39;, size=27, modificationTime=1652954550000)]</div>"]}}],"execution_count":0},{"cell_type":"code","source":["# File location and type\nfile_location = \"/superusersdata/animals.csv\"\nfile_type = \"csv\"\n\n# CSV options\ninfer_schema = \"true\"\nfirst_row_is_header = \"true\"\ndelimiter = \",\"\n\n# The applied options are for CSV files. For other file types, these will be ignored.\ndf = spark.read.format(file_type) \\\n  .option(\"inferSchema\", infer_schema) \\\n  .option(\"header\", first_row_is_header) \\\n  .option(\"sep\", delimiter) \\\n  .load(file_location)\n\npermanent_table_name = \"animalsTable\"\n\n#df.write.format(\"parquet\").saveAsTable(permanent_table_name)\ndf.write.format(\"delta\").saveAsTable(permanent_table_name)\n# default format er delta nu i den spark version vi kører her\n#df.write.saveAsTable(permanent_table_name)\n"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"e54de3ff-3459-4576-8e74-07aa0b535923"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\"></div>","removedWidgets":[],"addedWidgets":{},"metadata":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\"></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\nSELECT * FROM animalsTable"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"42527ace-ff3a-459c-93e7-02a9be20a9b3"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[[1,"Flodhest"],[2,"Kat"],[3,"Hund"]],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[{"name":"Id","type":"\"integer\"","metadata":"{}"},{"name":"Navn","type":"\"string\"","metadata":"{}"}],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>Id</th><th>Navn</th></tr></thead><tbody><tr><td>1</td><td>Flodhest</td></tr><tr><td>2</td><td>Kat</td></tr><tr><td>3</td><td>Hund</td></tr></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\nINSERT INTO animalsTable\nVALUES(4,'Giraf')"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"64200df8-e124-4628-985e-3fccaeca045d"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[[1,1]],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[{"name":"num_affected_rows","type":"\"long\"","metadata":"{}"},{"name":"num_inserted_rows","type":"\"long\"","metadata":"{}"}],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>num_affected_rows</th><th>num_inserted_rows</th></tr></thead><tbody><tr><td>1</td><td>1</td></tr></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\nDELETE FROM animalsTable\nWHERE Id=4"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"4123a2e6-8166-433b-887c-bcbd2efbb98e"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[[1]],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[{"name":"num_affected_rows","type":"\"long\"","metadata":"{}"}],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>num_affected_rows</th></tr></thead><tbody><tr><td>1</td></tr></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\nUPDATE animalsTable\nSET Navn='Flodhest'\nWHERE Id=1"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"8084f97c-7e6b-462f-8881-b45d610890f0"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[[1]],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[{"name":"num_affected_rows","type":"\"long\"","metadata":"{}"}],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>num_affected_rows</th></tr></thead><tbody><tr><td>1</td></tr></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\nDESCRIBE TABLE EXTENDED animalsTable"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"c89d7cca-b5ca-4eca-b0e0-cd7ef65fc418"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[["Id","int",""],["Navn","string",""],["","",""],["# Partitioning","",""],["Not partitioned","",""],["","",""],["# Detailed Table Information","",""],["Catalog","spark_catalog",""],["Database","default",""],["Table","animalsTable",""],["Location","dbfs:/user/hive/warehouse/animalstable",""],["Provider","delta",""],["Owner","root",""],["Is_managed_location","true",""],["Type","MANAGED",""],["Table Properties","[delta.minReaderVersion=1,delta.minWriterVersion=2]",""]],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[{"name":"col_name","type":"\"string\"","metadata":"{\"comment\":\"name of the column\"}"},{"name":"data_type","type":"\"string\"","metadata":"{\"comment\":\"data type of the column\"}"},{"name":"comment","type":"\"string\"","metadata":"{\"comment\":\"comment of the column\"}"}],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>col_name</th><th>data_type</th><th>comment</th></tr></thead><tbody><tr><td>Id</td><td>int</td><td></td></tr><tr><td>Navn</td><td>string</td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td># Partitioning</td><td></td><td></td></tr><tr><td>Not partitioned</td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr><tr><td># Detailed Table Information</td><td></td><td></td></tr><tr><td>Catalog</td><td>spark_catalog</td><td></td></tr><tr><td>Database</td><td>default</td><td></td></tr><tr><td>Table</td><td>animalsTable</td><td></td></tr><tr><td>Location</td><td>dbfs:/user/hive/warehouse/animalstable</td><td></td></tr><tr><td>Provider</td><td>delta</td><td></td></tr><tr><td>Owner</td><td>root</td><td></td></tr><tr><td>Is_managed_location</td><td>true</td><td></td></tr><tr><td>Type</td><td>MANAGED</td><td></td></tr><tr><td>Table Properties</td><td>[delta.minReaderVersion=1,delta.minWriterVersion=2]</td><td></td></tr></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%fs head dbfs:/user/hive/warehouse/animalstable/part-00000-tid-3664001450625542431-f9929b57-245c-4210-b585-abf6c98fa547-2406-1-c000.snappy.parquet"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"ec7b18e0-8049-4040-8b16-593862bae485"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">PAR1$(����\tD:&gt;����pHestKatHundHestKatV^l&lt;Hspark_schema%Id%Navn%L,&amp;5IdRV&amp;&lt;(��.&amp;^5Navnhl&amp;^&lt;6(KatHest��,�&amp;�\\org.apache.spark.timeZoneEtc/UTCorg.apache.spark.legacyINT96org.apache.spark.version3.2.1)org.apache.spark.sql.parquet.row.metadata�{&quot;type&quot;:&quot;struct&quot;,&quot;fields&quot;:[{&quot;name&quot;:&quot;Id&quot;,&quot;type&quot;:&quot;integer&quot;,&quot;nullable&quot;:true,&quot;metadata&quot;:{}},{&quot;name&quot;:&quot;Navn&quot;,&quot;type&quot;:&quot;string&quot;,&quot;nullable&quot;:true,&quot;metadata&quot;:{}}]}org.apache.spark.legacyDateTimeZparquet-mr version 1.12.0-databricks-0004 (build 3f1503a988efb3fab95bbf90481dfe0b9575ae6c),�PAR1\n</div>","removedWidgets":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">PAR1$(����\tD:&gt;����pHestKatHundHestKatV^l&lt;Hspark_schema%Id%Navn%L,&amp;5IdRV&amp;&lt;(��.&amp;^5Navnhl&amp;^&lt;6(KatHest��,�&amp;�\\org.apache.spark.timeZoneEtc/UTCorg.apache.spark.legacyINT96org.apache.spark.version3.2.1)org.apache.spark.sql.parquet.row.metadata�{&quot;type&quot;:&quot;struct&quot;,&quot;fields&quot;:[{&quot;name&quot;:&quot;Id&quot;,&quot;type&quot;:&quot;integer&quot;,&quot;nullable&quot;:true,&quot;metadata&quot;:{}},{&quot;name&quot;:&quot;Navn&quot;,&quot;type&quot;:&quot;string&quot;,&quot;nullable&quot;:true,&quot;metadata&quot;:{}}]}org.apache.spark.legacyDateTimeZparquet-mr version 1.12.0-databricks-0004 (build 3f1503a988efb3fab95bbf90481dfe0b9575ae6c),�PAR1\n</div>"]}}],"execution_count":0},{"cell_type":"code","source":["%fs\nls dbfs:/user/hive/warehouse/animalstable"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"e30f89c3-870c-4601-8c21-7c3eb353e3a0"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[["dbfs:/user/hive/warehouse/animalstable/_delta_log/","_delta_log/",0,1652958688000],["dbfs:/user/hive/warehouse/animalstable/part-00000-53225588-fa10-4c8d-8cf8-9c6a19d01516-c000.snappy.parquet","part-00000-53225588-fa10-4c8d-8cf8-9c6a19d01516-c000.snappy.parquet",830,1652958686000],["dbfs:/user/hive/warehouse/animalstable/part-00000-a06700a2-4a98-4de4-9095-39d896a77df4-c000.snappy.parquet","part-00000-a06700a2-4a98-4de4-9095-39d896a77df4-c000.snappy.parquet",816,1652958613000],["dbfs:/user/hive/warehouse/animalstable/part-00000-eca27f59-e6a4-41a3-b52e-69f63b45b951-c000.snappy.parquet","part-00000-eca27f59-e6a4-41a3-b52e-69f63b45b951-c000.snappy.parquet",818,1652958573000]],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"},{"name":"modificationTime","type":"\"long\"","metadata":"{}"}],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>path</th><th>name</th><th>size</th><th>modificationTime</th></tr></thead><tbody><tr><td>dbfs:/user/hive/warehouse/animalstable/_delta_log/</td><td>_delta_log/</td><td>0</td><td>1652958688000</td></tr><tr><td>dbfs:/user/hive/warehouse/animalstable/part-00000-53225588-fa10-4c8d-8cf8-9c6a19d01516-c000.snappy.parquet</td><td>part-00000-53225588-fa10-4c8d-8cf8-9c6a19d01516-c000.snappy.parquet</td><td>830</td><td>1652958686000</td></tr><tr><td>dbfs:/user/hive/warehouse/animalstable/part-00000-a06700a2-4a98-4de4-9095-39d896a77df4-c000.snappy.parquet</td><td>part-00000-a06700a2-4a98-4de4-9095-39d896a77df4-c000.snappy.parquet</td><td>816</td><td>1652958613000</td></tr><tr><td>dbfs:/user/hive/warehouse/animalstable/part-00000-eca27f59-e6a4-41a3-b52e-69f63b45b951-c000.snappy.parquet</td><td>part-00000-eca27f59-e6a4-41a3-b52e-69f63b45b951-c000.snappy.parquet</td><td>818</td><td>1652958573000</td></tr></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\nDROP TABLE animalsTable"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"734a706c-237d-4842-8efc-32f06124d0ab"}},"outputs":[],"execution_count":0},{"cell_type":"code","source":["%sql\nDESCRIBE history animalsTable"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"d20aedf2-ac12-4f53-97d2-b0420ef0cb3a"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[[4,"2022-05-19T11:18:13.000+0000","819675187835380","su20220516@outlook.com","RESTORE",{"version":"1","timestamp":null},null,["4498784072223422"],"0516-113437-ufeg20q4",3,"Serializable",false,{"numRestoredFiles":"2","removedFilesSize":"830","numRemovedFiles":"1","restoredFilesSize":"1634","numOfFilesAfterRestore":"2","tableSizeAfterRestore":"1634"},null,"Databricks-Runtime/10.5.x-scala2.12"],[3,"2022-05-19T11:11:26.000+0000","819675187835380","su20220516@outlook.com","UPDATE",{"predicate":"(Id#1602 = 1)"},null,["4498784072223422"],"0516-113437-ufeg20q4",2,"WriteSerializable",false,{"numRemovedFiles":"1","numCopiedRows":"2","numAddedChangeFiles":"0","executionTimeMs":"1545","scanTimeMs":"48","numAddedFiles":"1","numUpdatedRows":"1","rewriteTimeMs":"1494"},null,"Databricks-Runtime/10.5.x-scala2.12"],[2,"2022-05-19T11:10:50.000+0000","819675187835380","su20220516@outlook.com","DELETE",{"predicate":"[\"(spark_catalog.default.animalsTable.Id = 4)\"]"},null,["4498784072223422"],"0516-113437-ufeg20q4",1,"WriteSerializable",false,{"numRemovedFiles":"1","numCopiedRows":"0","numAddedChangeFiles":"0","executionTimeMs":"2707","numDeletedRows":"1","scanTimeMs":"1969","numAddedFiles":"0","rewriteTimeMs":"735"},null,"Databricks-Runtime/10.5.x-scala2.12"],[1,"2022-05-19T11:10:14.000+0000","819675187835380","su20220516@outlook.com","WRITE",{"mode":"Append","partitionBy":"[]"},null,["4498784072223422"],"0516-113437-ufeg20q4",0,"WriteSerializable",true,{"numFiles":"1","numOutputRows":"1","numOutputBytes":"816"},null,"Databricks-Runtime/10.5.x-scala2.12"],[0,"2022-05-19T11:09:35.000+0000","819675187835380","su20220516@outlook.com","CREATE TABLE AS SELECT",{"isManaged":"true","description":null,"partitionBy":"[]","properties":"{}"},null,["4498784072223422"],"0516-113437-ufeg20q4",null,"WriteSerializable",true,{"numFiles":"1","numOutputRows":"3","numOutputBytes":"818"},null,"Databricks-Runtime/10.5.x-scala2.12"]],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[{"name":"version","type":"\"long\"","metadata":"{}"},{"name":"timestamp","type":"\"timestamp\"","metadata":"{}"},{"name":"userId","type":"\"string\"","metadata":"{}"},{"name":"userName","type":"\"string\"","metadata":"{}"},{"name":"operation","type":"\"string\"","metadata":"{}"},{"name":"operationParameters","type":"{\"type\":\"map\",\"keyType\":\"string\",\"valueType\":\"string\",\"valueContainsNull\":true}","metadata":"{}"},{"name":"job","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"jobId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"jobName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"runId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"jobOwnerId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"triggerType\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"notebook","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"notebookId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"clusterId","type":"\"string\"","metadata":"{}"},{"name":"readVersion","type":"\"long\"","metadata":"{}"},{"name":"isolationLevel","type":"\"string\"","metadata":"{}"},{"name":"isBlindAppend","type":"\"boolean\"","metadata":"{}"},{"name":"operationMetrics","type":"{\"type\":\"map\",\"keyType\":\"string\",\"valueType\":\"string\",\"valueContainsNull\":true}","metadata":"{}"},{"name":"userMetadata","type":"\"string\"","metadata":"{}"},{"name":"engineInfo","type":"\"string\"","metadata":"{}"}],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>version</th><th>timestamp</th><th>userId</th><th>userName</th><th>operation</th><th>operationParameters</th><th>job</th><th>notebook</th><th>clusterId</th><th>readVersion</th><th>isolationLevel</th><th>isBlindAppend</th><th>operationMetrics</th><th>userMetadata</th><th>engineInfo</th></tr></thead><tbody><tr><td>4</td><td>2022-05-19T11:18:13.000+0000</td><td>819675187835380</td><td>su20220516@outlook.com</td><td>RESTORE</td><td>Map(version -> 1, timestamp -> null)</td><td>null</td><td>List(4498784072223422)</td><td>0516-113437-ufeg20q4</td><td>3</td><td>Serializable</td><td>false</td><td>Map(numRestoredFiles -> 2, removedFilesSize -> 830, numRemovedFiles -> 1, restoredFilesSize -> 1634, numOfFilesAfterRestore -> 2, tableSizeAfterRestore -> 1634)</td><td>null</td><td>Databricks-Runtime/10.5.x-scala2.12</td></tr><tr><td>3</td><td>2022-05-19T11:11:26.000+0000</td><td>819675187835380</td><td>su20220516@outlook.com</td><td>UPDATE</td><td>Map(predicate -> (Id#1602 = 1))</td><td>null</td><td>List(4498784072223422)</td><td>0516-113437-ufeg20q4</td><td>2</td><td>WriteSerializable</td><td>false</td><td>Map(numRemovedFiles -> 1, numCopiedRows -> 2, numAddedChangeFiles -> 0, executionTimeMs -> 1545, scanTimeMs -> 48, numAddedFiles -> 1, numUpdatedRows -> 1, rewriteTimeMs -> 1494)</td><td>null</td><td>Databricks-Runtime/10.5.x-scala2.12</td></tr><tr><td>2</td><td>2022-05-19T11:10:50.000+0000</td><td>819675187835380</td><td>su20220516@outlook.com</td><td>DELETE</td><td>Map(predicate -> [\"(spark_catalog.default.animalsTable.Id = 4)\"])</td><td>null</td><td>List(4498784072223422)</td><td>0516-113437-ufeg20q4</td><td>1</td><td>WriteSerializable</td><td>false</td><td>Map(numRemovedFiles -> 1, numCopiedRows -> 0, numAddedChangeFiles -> 0, executionTimeMs -> 2707, numDeletedRows -> 1, scanTimeMs -> 1969, numAddedFiles -> 0, rewriteTimeMs -> 735)</td><td>null</td><td>Databricks-Runtime/10.5.x-scala2.12</td></tr><tr><td>1</td><td>2022-05-19T11:10:14.000+0000</td><td>819675187835380</td><td>su20220516@outlook.com</td><td>WRITE</td><td>Map(mode -> Append, partitionBy -> [])</td><td>null</td><td>List(4498784072223422)</td><td>0516-113437-ufeg20q4</td><td>0</td><td>WriteSerializable</td><td>true</td><td>Map(numFiles -> 1, numOutputRows -> 1, numOutputBytes -> 816)</td><td>null</td><td>Databricks-Runtime/10.5.x-scala2.12</td></tr><tr><td>0</td><td>2022-05-19T11:09:35.000+0000</td><td>819675187835380</td><td>su20220516@outlook.com</td><td>CREATE TABLE AS SELECT</td><td>Map(isManaged -> true, description -> null, partitionBy -> [], properties -> {})</td><td>null</td><td>List(4498784072223422)</td><td>0516-113437-ufeg20q4</td><td>null</td><td>WriteSerializable</td><td>true</td><td>Map(numFiles -> 1, numOutputRows -> 3, numOutputBytes -> 818)</td><td>null</td><td>Databricks-Runtime/10.5.x-scala2.12</td></tr></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\nSELECT * FROM animalsTable"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"300a7902-db69-4d82-a145-e8d7f8e1298f"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[[1,"Hest"],[2,"Kat"],[3,"Hund"],[4,"Giraf"]],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[{"name":"Id","type":"\"integer\"","metadata":"{}"},{"name":"Navn","type":"\"string\"","metadata":"{}"}],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>Id</th><th>Navn</th></tr></thead><tbody><tr><td>1</td><td>Hest</td></tr><tr><td>2</td><td>Kat</td></tr><tr><td>3</td><td>Hund</td></tr><tr><td>4</td><td>Giraf</td></tr></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\n--https://docs.databricks.com/spark/latest/spark-sql/language-manual/delta-restore.html\nRESTORE TABLE animalsTable TO VERSION AS OF 1"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"2126b2ef-8ecb-401d-ae5c-5b5162a0440e"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[[1634,2,1,2,830,1634]],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[{"name":"table_size_after_restore","type":"\"long\"","metadata":"{}"},{"name":"num_of_files_after_restore","type":"\"long\"","metadata":"{}"},{"name":"num_removed_files","type":"\"long\"","metadata":"{}"},{"name":"num_restored_files","type":"\"long\"","metadata":"{}"},{"name":"removed_files_size","type":"\"long\"","metadata":"{}"},{"name":"restored_files_size","type":"\"long\"","metadata":"{}"}],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>table_size_after_restore</th><th>num_of_files_after_restore</th><th>num_removed_files</th><th>num_restored_files</th><th>removed_files_size</th><th>restored_files_size</th></tr></thead><tbody><tr><td>1634</td><td>2</td><td>1</td><td>2</td><td>830</td><td>1634</td></tr></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%fs ls dbfs:/superusersdata/"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"271509e6-4f12-4adf-9d02-a57b7aa8c390"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[["dbfs:/superusersdata/animals.csv","animals.csv",27,1652954550000]],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"},{"name":"modificationTime","type":"\"long\"","metadata":"{}"}],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>path</th><th>name</th><th>size</th><th>modificationTime</th></tr></thead><tbody><tr><td>dbfs:/superusersdata/animals.csv</td><td>animals.csv</td><td>27</td><td>1652954550000</td></tr></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\nDROP TABLE IF EXISTS animals;\n\nCREATE TABLE animals\nUSING csv\nOPTIONS (path \"dbfs:/superusersdata/*.csv\", header \"true\")"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"430b92b7-672c-407f-8656-5761645b7f99"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr></tr></thead><tbody></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\nSELECT * FROM animals"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"b1551982-b377-40d3-8c7c-c5f12a5b14c3"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[["5","Flodhest"],["6","Tiger"],["7","And"],["1","Hest"],["2","Kat"],["3","Hund"]],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[{"name":"Id","type":"\"string\"","metadata":"{}"},{"name":"Navn","type":"\"string\"","metadata":"{}"}],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>Id</th><th>Navn</th></tr></thead><tbody><tr><td>5</td><td>Flodhest</td></tr><tr><td>6</td><td>Tiger</td></tr><tr><td>7</td><td>And</td></tr><tr><td>1</td><td>Hest</td></tr><tr><td>2</td><td>Kat</td></tr><tr><td>3</td><td>Hund</td></tr></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\nDESCRIBE TABLE EXTENDED animals"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"cf8f7c77-d817-410d-8433-673583867cb7"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[["Id","string",null],["Navn","string",null],["","",""],["# Detailed Table Information","",""],["Database","default",""],["Table","animals",""],["Owner","root",""],["Created Time","Thu May 19 11:20:30 UTC 2022",""],["Last Access","UNKNOWN",""],["Created By","Spark 3.2.1",""],["Type","EXTERNAL",""],["Provider","csv",""],["Location","dbfs:/superusersdata/animals.csv",""],["Serde Library","org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe",""],["InputFormat","org.apache.hadoop.mapred.SequenceFileInputFormat",""],["OutputFormat","org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat",""],["Storage Properties","[header=true]",""]],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[{"name":"col_name","type":"\"string\"","metadata":"{\"comment\":\"name of the column\"}"},{"name":"data_type","type":"\"string\"","metadata":"{\"comment\":\"data type of the column\"}"},{"name":"comment","type":"\"string\"","metadata":"{\"comment\":\"comment of the column\"}"}],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>col_name</th><th>data_type</th><th>comment</th></tr></thead><tbody><tr><td>Id</td><td>string</td><td>null</td></tr><tr><td>Navn</td><td>string</td><td>null</td></tr><tr><td></td><td></td><td></td></tr><tr><td># Detailed Table Information</td><td></td><td></td></tr><tr><td>Database</td><td>default</td><td></td></tr><tr><td>Table</td><td>animals</td><td></td></tr><tr><td>Owner</td><td>root</td><td></td></tr><tr><td>Created Time</td><td>Thu May 19 11:20:30 UTC 2022</td><td></td></tr><tr><td>Last Access</td><td>UNKNOWN</td><td></td></tr><tr><td>Created By</td><td>Spark 3.2.1</td><td></td></tr><tr><td>Type</td><td>EXTERNAL</td><td></td></tr><tr><td>Provider</td><td>csv</td><td></td></tr><tr><td>Location</td><td>dbfs:/superusersdata/animals.csv</td><td></td></tr><tr><td>Serde Library</td><td>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</td><td></td></tr><tr><td>InputFormat</td><td>org.apache.hadoop.mapred.SequenceFileInputFormat</td><td></td></tr><tr><td>OutputFormat</td><td>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</td><td></td></tr><tr><td>Storage Properties</td><td>[header=true]</td><td></td></tr></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\nSELECT *\nFROM   animals"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"433e4d8e-2180-4fd6-ad58-0a3a4a9831de"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[["5","Flodhest"],["6","Tiger"],["7","And"],["1","Hest"],["2","Kat"],["3","Hund"]],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[{"name":"Id","type":"\"string\"","metadata":"{}"},{"name":"Navn","type":"\"string\"","metadata":"{}"}],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>Id</th><th>Navn</th></tr></thead><tbody><tr><td>5</td><td>Flodhest</td></tr><tr><td>6</td><td>Tiger</td></tr><tr><td>7</td><td>And</td></tr><tr><td>1</td><td>Hest</td></tr><tr><td>2</td><td>Kat</td></tr><tr><td>3</td><td>Hund</td></tr></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["foldername=\"superusersdata\"\nfilename=\"animals2.csv\"\ndbutils.fs.mkdirs(foldername)\nfilepath=foldername+\"/\"+filename\ndata=\"Id,Navn\\n5,Flodhest\\n6,Tiger\\n7,And\"\ndbutils.fs.put(filepath,data,True)"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"33981275-4805-40d2-b037-8b81a31265ba"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">Wrote 32 bytes.\nOut[7]: True</div>","removedWidgets":[],"addedWidgets":{},"metadata":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">Wrote 32 bytes.\nOut[7]: True</div>"]}}],"execution_count":0},{"cell_type":"code","source":["foldername=\"superusersdata\"\nfilename=\"animals3.csv\"\ndbutils.fs.mkdirs(foldername)\nfilepath=foldername+\"/\"+filename\ndata=\"Id,Navn\\n4,Kamel\"\ndbutils.fs.put(filepath,data,True)"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"00e10321-8398-46fa-a7b9-f497bcb806a1"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"datasetInfos":[],"data":"<div class=\"ansiout\">Wrote 15 bytes.\nOut[8]: True</div>","removedWidgets":[],"addedWidgets":{},"metadata":{},"type":"html","arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .ansiout {\n    display: block;\n    unicode-bidi: embed;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    word-break: break-all;\n    font-family: \"Source Code Pro\", \"Menlo\", monospace;;\n    font-size: 13px;\n    color: #555;\n    margin-left: 4px;\n    line-height: 19px;\n  }\n</style>\n<div class=\"ansiout\">Wrote 15 bytes.\nOut[8]: True</div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\nREfRESH TABLE animals"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"8b648abe-c1cd-4b99-acea-abe178d9f4bb"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr></tr></thead><tbody></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\nSELECT *\nFROM   animals"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"8d595a78-94b4-4680-9a6a-86bb6f7dd07f"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[["5","Flodhest"],["6","Tiger"],["7","And"],["1","Hest"],["2","Kat"],["3","Hund"]],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[{"name":"Id","type":"\"string\"","metadata":"{}"},{"name":"Navn","type":"\"string\"","metadata":"{}"}],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>Id</th><th>Navn</th></tr></thead><tbody><tr><td>5</td><td>Flodhest</td></tr><tr><td>6</td><td>Tiger</td></tr><tr><td>7</td><td>And</td></tr><tr><td>1</td><td>Hest</td></tr><tr><td>2</td><td>Kat</td></tr><tr><td>3</td><td>Hund</td></tr></tbody></table></div>"]}}],"execution_count":0},{"cell_type":"code","source":["%sql\nSELECT count(*) AS Antal\nFROM   animals"],"metadata":{"application/vnd.databricks.v1+cell":{"title":"","showTitle":false,"inputWidgets":{},"nuid":"9684ad6a-3344-4091-aab7-b52e4ea0a546"}},"outputs":[{"output_type":"display_data","metadata":{"application/vnd.databricks.v1+output":{"overflow":false,"datasetInfos":[],"data":[[6]],"plotOptions":{"displayType":"table","customPlotOptions":{},"pivotColumns":null,"pivotAggregation":null,"xColumns":null,"yColumns":null},"columnCustomDisplayInfos":{},"aggType":"","isJsonSchema":true,"removedWidgets":[],"aggSchema":[],"schema":[{"name":"Antal","type":"\"long\"","metadata":"{}"}],"aggError":"","aggData":[],"addedWidgets":{},"metadata":{"isDbfsCommandResult":false},"dbfsResultPath":null,"type":"table","aggOverflow":false,"aggSeriesLimitReached":false,"arguments":{}}},"output_type":"display_data","data":{"text/html":["<style scoped>\n  .table-result-container {\n    max-height: 300px;\n    overflow: auto;\n  }\n  table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n  }\n  th, td {\n    padding: 5px;\n  }\n  th {\n    text-align: left;\n  }\n</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>Antal</th></tr></thead><tbody><tr><td>6</td></tr></tbody></table></div>"]}}],"execution_count":0}],"metadata":{"application/vnd.databricks.v1+notebook":{"notebookName":"Delta tables demo","dashboards":[],"notebookMetadata":{"pythonIndentUnit":4},"language":"python","widgets":{},"notebookOrigID":4498784072223422}},"nbformat":4,"nbformat_minor":0}
